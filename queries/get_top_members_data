SELECT
FIRST @pageSize@
  coder_id AS user_id
, (SELECT handle FROM coder c WHERE c.coder_id = ar.coder_id) AS handle
, rating
, (CASE WHEN algo_rating_type_id = 1 THEN 'algorithm' ELSE 'marathon' END) AS challenge_type
FROM algo_rating ar
WHERE ar.algo_rating_type_id = 1 
OR ar.algo_rating_type_id = 3
ORDER BY rating DESC
